import{aE as ul,r as C}from"./index.13ee457d.js";const rl=ul("production-calc",()=>{const I=C(0),q=C(0),a=C([]),_e=C(0),Oe=C(0),z=C(0),Q=C(0),Pe=C(0),Ne=C(!1),re=C(!1),de=C(!1),i=C({}),ee=C({}),Ye=C(!1),v=2,Z=1/30,We=1/(60*30),je=1e4,E=C(0),G=C(0);function De(h={},x,w,S,n,r=[]){const t=h.ingredient_percentage;let u=1;x==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25B2\u25B2"?u=S:w==="\uC2DD\uC7AC\uB8CC \uB3C4\uC6B0\uBBF8 \uD655\uB960 \u25BD\u25BD"&&(u=n);let o=1;for(let e=0;e<r.length;e++)(r[e].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 M"||r[e].label==="\uC2DD\uC7AC\uB8CC \uD655\uB960 \uC5C5 s")&&(o+=r[e].mult);return t*u*o/100}function Le(h={},x,w,S,n,r=[]){const t=h.skill_percentage,u=x==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25B2\u25B2"?S:w==="\uBA54\uC778 \uC2A4\uD0AC \uBC1C\uB3D9\uB960 \u25BD\u25BD"?n:1;let o=1;for(let e=0;e<r.length;e++)(r[e].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 M"||r[e].label==="\uC2A4\uD0AC \uD655\uB960 \uC5C5 s")&&(o+=r[e].mult);return t*u*o/100}function Ie(h,x,w,S,n,r,t,u,o=[],e={},c,b){const d=w==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25B2\u25B2"?n:S==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC \u25BD\u25BD"?r:1,m=t*u;let p=0;for(let f=0;f<o.length;f++)(o[f].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC M"||o[f].label==="\uB3C4\uC6B0\uBBF8 \uC2A4\uD53C\uB4DC s"||o[f].label==="\uB3C4\uC6B0\uBBF8 \uBCF4\uB108\uC2A4")&&(p+=o[f].mult);p=p+m>=c?c:p+m;const k=(501-x)/500*d*(1-p)*(1-h/100),s=b?.8:1;return e.frequency*k*We*s}function el(h=!1,x=100,w,S,n,r,t,u,o,e,c,b,d,m,p,k="",s,f,A,le,ae,B,K,Ae,ye,T,U,te,oe=[],ce=0,ge="",xe="",Y="",we="",Re="",y=!1){a.value=[];let g=te.main_skills.amount[p-1],X=c.main_skills.amount[e-1],ke=!1,be=1;c.main_skills.name.includes("Charge Energy")?(ke=!0,be=1):c.main_skills.name.includes("Energizing Cheer")?(ke=!0,be=5):c.main_skills.name.includes("Energy For Everyone")&&(ke=!0,be=1);let Je=k.split(":");const ve=parseInt(Je[0],10),fe=parseInt(Je[1],10),se=24*v-ve*v-fe*Z,Xe=se-1,He=Xe-Math.floor((se-7*v)/2),Qe=He-6*v;function Fe(R){for(const ne of b)if(R>=ne.e)return ne.m}let $e=1;le==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?($e=B,g=Math.floor(g*B),X=Math.floor(X*B)):ae==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&($e=K,g=Math.floor(g*K),X=Math.floor(X*K));const Be=h?x:100,Ze=Ae*ye+1;let N=Be/(A/v)*(ve*v+fe*Z)*$e*Ze;N=N>Be?Be:Math.floor(N);function O(R){return R>m?m:R}if(s!=="proVer"){let D=function(l,j=1,J=g){let H=0;switch(l===0?H=N+J:a.value[a.value.length-1].y<=0?H=J*j:H=a.value[a.value.length-1].y+J*j-Math.floor(T/v),H){case H>m:return m;case H<0:return 0;default:return H}};a.value.push({x:0,y:N}),s!=="lightVer"&&(g=0);const R=s==="lightVer"?Math.floor(se/f):0,ne=E.value>0?Math.floor(se/E.value):1;let W=f;for(let l=0;l<se+1;l++){let j=D(l,0);if(a.value.push({x:l,y:j}),l===0&&(W-=1),(l===Qe||l===He||l===Xe)&&a.value.push({x:l,y:O(j+Fe(j))}),ke&&(l%ne===0||l===0)&&E.value>0){let J=D(l,1,X);a.value.push({x:l,y:O(J)}),E.value-=1}if(l>0&&s==="lightVer"&&l%R===0&&W>0){let J=D(l);a.value.push({x:l,y:O(J)}),W-=1}}G.value=Ce("me",w,k,a.value[a.value.length-1].y,U,c,r,n,t,u,o,T,d)}else if(s==="proVer"){let he=function(M,F,me){let ue=me>m?m:me;M>0?a.value[F].y=(a.value[F].y*M+ue)/(M+1):a.value.push({x:F,y:ue})},ol=function(M){let F=0;return l>0&&(l=l-1*(T/v),l>m&&(l=m)),l<=0&&(l=0),a.value[M-1].y>0&&(F=a.value[M-1].y-1*(T/v),F>m&&(F=m)),F<0?0:F},R=te.main_skills.amount[p-1],ne=1;we==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25B2\u25B2"?(ne=B,R=Math.floor(R*B)):Re==="\uAE30\uB825 \uD68C\uBCF5\uB7C9 \u25BD\u25BD"&&(ne=K,R=Math.floor(R*K));const D=y?x:100;let W=D/(A/v)*(ve*v+fe*Z)*ne*Ze;W=W>D?D:W;let l=W,j=.8,J=0,H=.4,qe=0;for(let M=0;M<je;M++){let F=Math.random(),me=Math.random(),ue=0;F<j?(l+=R,ue=1,F<J&&(l+=R,l=O(Math.floor(l)),ue=2),me<H?me<qe?he(M,0,O(N+X*2+g*ue)):he(M,0,O(N+X+g*ue)):he(M,0,O(N+g*ue))):me<H?me<qe?he(M,0,O(N+X*2)):he(M,0,O(N+X)):he(M,0,O(N));let Se=q.value,Me=I.value;for(let V=1;V<se+1;V++){let Ve=function(_){for(let P=0;P<U.length;P++)if(_>U[P].e)return Ke=U[P].e,U[P].m;return U[U.length-1].m},Ge=function(_,P,$){return(P-$)/(T/v)+_};l=O(l);const Ee=l;let L=ol(V),Ke=0;const Ue=Ve(l),pe=Ve(Ee);let Te=0;if(Ue!==pe){let _=Ge(V-1,Ee,Ke)-(V-1);Se=Se-(_/pe+(1-_)/Ue)%q.value,Te=Math.floor((_/pe+(1-_)/Ue)/q.value)}else Se=Se-1/pe%q.value,Te=Math.floor(1/pe/q.value);if(Se<=0&&(Te+=1,Se+=q.value),ke){let _=0;const P=Ve(L),$=Ve(a.value[V-1].y);if(P!==$){let ze=Ge(V-1,a.value[V-1].y,Ke)-(V-1);Me=Me-(ze/$+(1-ze)/P)%I.value,_=Math.floor((ze/$+(1-ze)/P)/I.value)}else Me=Me-1/pe%q.value,_=Math.floor(1/pe/q.value);Me<=0&&(_+=1,Me+=I.value),(V===Qe||V===He||V===Xe)&&(L+=Fe(L),l+=Fe(l));const ie=1-Math.pow(1-z.value/be,_);_>0&&Math.random()<ie&&(L+=X)}const nl=1-Math.pow(1-Q.value,Te);if(Te>0&&Math.random()<nl&&(L+=g,l+=R),he(M,V,O(L)),l=O(l),V===se){let _=l,P=0;if(L-Math.ceil(T/v*(ve*v+fe*Z))<0?P=0:P=L-Math.ceil(T/v*(ve*v+fe*Z)),l-Math.ceil(T/v*(ve*v+fe*Z))<0?l=0:l=l-Math.ceil(T/v*(ve*v+fe*Z)),N=P+N>Be?Be:P+N,l=l+W>D?D:l+W,ke){const ie=Ce("me",w,k,L,U,c,r,n,t,u,o,T,d);H=1-Math.pow(1-z.value/be,ie),c.specialty=="skill"&&(H=ie*z.value*Math.pow(1-z.value,ie-1),qe=1-Math.pow(1-z.value,ie)-ie*z.value*Math.pow(1-z.value,ie-1))}const $=Ce("healer",S,k,_,U,te,oe,ce,ge,xe,Y,T,d);j=1-Math.pow(1-Q.value,$),te.specialty=="skill"&&(j=$*Q.value*Math.pow(1-Q.value,$-1),J=1-Math.pow(1-Q.value,$)-$*Q.value*Math.pow(1-Q.value,$-1))}}}}}function ll(h=[],x="target",w,S){ee.value={},h.forEach(e=>{ee.value[e.m]=0});let n=0;function r(e){for(let c=0;c<h.length;c++)if(e>h[c].e)return n=h[c].e,h[c].m;return n=h[h.length-1].e,h[h.length-1].m}function t(e,c,b){return(b-a.value[e].y)/((a.value[e].y-a.value[c].y)/(a.value[e].x-a.value[c].x))+a.value[e].x}for(let e=0;e<a.value.length-1;e++)if(a.value[e].x!==a.value[e+1].x){let c=r(a.value[e+1].y),b=a.value[e].x,d=!0,m=a.value[e+1].x;x==="proVer"&&a.value[e].y<=a.value[e+1].y&&(c=r(a.value[e].y-w/v*(a.value[e+1].x-a.value[e].x)));let p=r(a.value[e].y);for(;d;)p===c?(ee.value[p]+=a.value[e+1].x-b,d=!1):(m=t(e,e+1,n),ee.value[p]+=m-b,p=r(n),b=m)}let u=0;for(let e in ee.value)u+=ee.value[e]/parseFloat(e);Pe.value=Math.floor(u/I.value);const o=G.value*z.value>S?S:G.value*z.value;E.value=Pe.value*z.value+o}function al(h,x,w,S=!1,n={},r,t,u,o,e,c,b,d,m,p){h==="proVer"&&(G.value=Ce("me",x,e,a.value[a.value.length-1].y,b,n,d,r,t,u,o,c,m));function k(s,f){const A=n[`ingredient${f}`].find(le=>le.name===s).amount;return S?G.value*_e.value*A:(Pe.value+G.value)*_e.value*A}if(i.value[t]=k(t,0),r>=30&&(u===t?(i.value[t]=(i.value[t]+k(u,30))/2,Ne.value=!1):(i.value[t]=i.value[t]/2,i.value[u]=k(u,30)/2,Ne.value=!0),r>=60&&(i.value[t]=i.value[t]*2/3,t===u?o!==u?(i.value[o]=k(o,60)/3,re.value=!0):(i.value[t]=i.value[t]+k(o,60)/3,re.value=!1):(i.value[u]=i.value[u]*2/3,o===t?(i.value[t]=i.value[t]+k(o,60)/3,re.value=!1):o===u?(i.value[u]=i.value[u]+k(o,60)/3,re.value=!1):(i.value[o]=k(o,60)/3,re.value=!0)))),n.main_skills.unit==="ingredients"){if(Math.min(G.value*z.value,w),n.main_skills.name.includes("Magnet"))(async()=>{try{const f=(await fetch("https://rxgqybcxgapiftblwttl.supabase.co/rest/v1/ingredients?select=name&limit=1",{headers:{apikey:{}.VITE_SUPABASE_API_KEY,Authorization:`Bearer ${{}.VITE_SUPABASE_API_KEY}`,Prefer:"count=exact"}})).headers.get("content-range"),A=f?parseInt(f.split("/")[1]):null,le=Math.ceil(n.main_skills.amount[p-1]/3),ae=1-(1-1/A)*(1-1/(A-1))*(1-1/(A-2)),B=E.value*le*ae;de.value=!0,i.value[t]+=B,i.value.hasOwnProperty(u)&&(i.value[u]+=B),i.value.hasOwnProperty(o)&&(i.value[o]+=B),i.value.all=B}catch(s){console.log("ing Fetch problem: "+s.message)}})();else if(n.main_skills.name.includes("Draw")){const s=E.value*n.main_skills.avg_amount[p-1]/n.main_skills.selection.length;n.main_skills.selection.forEach(f=>{i.value.hasOwnProperty(f)?i.value[f]+=s:i.value[f]=s})}}}function Ce(h,x,w,S,n,r,t,u,o,e,c,b,d){let m=w.split(":");const p=parseInt(m[0],10),k=parseInt(m[1],10),s=h==="healer"?Oe.value:_e.value;let f={};n.forEach(y=>{f[y.m]=0});let A=0;function le(y){for(let g=0;g<n.length;g++)if(y>n[g].e)return A=n[g].e,n[g].m;return A=0,n[n.length-1].m}let ae=le(S),B=0,K=(S-A)/(b/v);for(;ae!==n[n.length-1].m;)f[ae]+=K-B,ae=le(A),B=K,K=(S-A)/(b/v);K=p*v+k*Z,f[ae]+=K-B;let Ae=0;for(let y in f)Ae+=f[y]/parseFloat(y);let ye=0;h==="me"?ye=Math.floor(Ae/I.value):ye=Math.floor(Ae/q.value);let T=!1;const U=d?1.2:1;let te=(r.carry_size+r.previous_evolutions*5)*U+x;for(let y=0;y<t.length;y++)t[y].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 L"||t[y].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 M"||t[y].label==="\uCD5C\uB300 \uC18C\uC9C0 \uC218 \uC5C5 s"?te+=t[y].mult:t[y].label==="\uB098\uBB34\uC5F4\uB9E4 \uC218 s"&&(T=!0);function oe(y,g){return r[`ingredient${g}`].find(X=>X.name===y).amount}let ce=0,ge=0,xe=0,Y=1;switch(!0){case u>=60:Y=3,ce=oe(o,0)*s/Y,ge=oe(e,30)*s/Y,xe=oe(c,60)*s/Y;break;case u>=30:Y=2,ce=oe(o,0)*s/Y,ge=oe(e,30)*s/Y;break;default:Y=1,ce=oe(o,0)*s/Y}let we=1;r.specialty==="berry"&&(we+=1),T&&(we+=1);const Re=we*(1-s);return Math.ceil(te/(Re+ce+ge+xe))>ye?ye:Math.ceil(te/(Re+ce+ge+xe))}function tl(){I.value=0,q.value=0,a.value=[],Pe.value=0,_e.value=0,Oe.value=0,z.value=0,Q.value=0,Ne.value=!1,re.value=!1,de.value=!1,Ye.value=!1,i.value={},ee.value={},E.value=0,G.value=0}return{onlyBaseSpeed:I,onlyBaseSpeedH:q,energyAxis:a,finalSpeedCount:Pe,finalIngProc:_e,finalIngProcH:Oe,finalSkillProc:z,finalSkillProcH:Q,checkSecondDisplay:Ne,checkThirdDisplay:re,checkIngSkillDisplay:de,totalIngCalc:i,timeStaying:ee,calcLoading:Ye,convertH:v,convertM:Z,convertS:We,simulationCount:je,selfSkillCount:E,helpCountSleep:G,calcIngProc:De,calcBaseSpeed:Ie,calcEnergyCurve:el,calcSpeedWithEner:ll,clearCalc:tl,calcSleepSpeedCount:Ce,calcLeveLIng:al,calcSkillProc:Le}});export{rl as u};
